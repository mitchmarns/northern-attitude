<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Character | Northern Attitude</title>
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="https://use.typekit.net/eat5uwv.css">
</head>
<body>
    <header>
        <div class="container header-content">
            <div class="logo">northern<span>attitude</span></div>
            <nav>
                <ul>
                    <li><a href="dash.html">Dashboard</a></li>
                    <li><a href="my-characters.html">Players</a></li>
                    <li><a href="teams.html">Teams</a></li>
                    <li><a href="#">Games</a></li>
                    <li><a href="messages.html">Messages</a></li>
                </ul>
            </nav>
            <div class="user-container">
                <span id="username-display" class="username-display"></span>
                <span> | </span>
                <a href="#" id="logout-link" class="logout-link">Log Out</a>
            </div>
        </div>
    </header>
    
    <main>
        <div class="container">
            <div class="content-header">
                <h2 id="form-title">Create New Character</h2>
                <a href="my-characters.html" class="btn btn-secondary">Back to My Characters</a>
            </div>
            
            <div id="character-form-error" class="auth-error" style="display: none;"></div>
            <div id="character-form-success" class="auth-success" style="display: none;"></div>
            
            <div class="form-container">
                <form id="character-form">
                    <!-- Character Type Selection Section -->
                    <div class="form-section">
                        <h3 class="form-section-title">Character Type</h3>
                        
                        <div class="character-type-select">
                            <div class="character-type-option" data-type="player">
                                <h4>Player</h4>
                                <p>Hockey athletes on the ice</p>
                            </div>
                            <div class="character-type-option" data-type="coach">
                                <h4>Coach</h4>
                                <p>Team managers and trainers</p>
                            </div>
                            <div class="character-type-option" data-type="staff">
                                <h4>Team Staff</h4>
                                <p>Support personnel and management</p>
                            </div>
                            <div class="character-type-option" data-type="executive">
                                <h4>League Executive</h4>
                                <p>League administrators and officials</p>
                            </div>
                            <div class="character-type-option" data-type="fan">
                                <h4>Fan/Supporter</h4>
                                <p>Passionate team and league enthusiasts</p>
                            </div>
                            <div class="character-type-option" data-type="media">
                                <h4>Media</h4>
                                <p>Journalists, broadcasters, analysts</p>
                            </div>
                        </div>

                        <!-- Hidden input to store character type value -->
                        <input type="hidden" id="character-type" name="character-type" required>
                        
                        <div id="character-type-description" class="character-type-description">
                            Select a character type to see more details.
                        </div>
                    </div>
                    
                    <!-- Role Selection (for non-player types) -->
                    <div id="role-selection" class="form-section" style="display: none;">
                        <h3 class="form-section-title">Role Selection</h3>
                        <div id="role-options" class="role-options">
                            <!-- Roles will be dynamically populated -->
                        </div>
                    </div>

                    <div class="form-section">
                        <h3 class="form-section-title">Basic Information</h3>

                        <div class="form-group">
                            <label for="avatar-url">Character Avatar URL</label>
                            <input
                                type="url"
                                id="avatar-url"
                                class="form-control"
                                placeholder="https://example.com/your-image.jpg"
                            />
                            <p class="form-text">
                                Enter a URL to an image for your character's avatar
                            </p>
                        </div>

                        <div class="character-avatar-container">
                            <div class="character-avatar-preview">
                                <img
                                    id="avatar-image"
                                    src="/api/placeholder/120/120"
                                    alt="Character avatar"
                                />
                            </div>
                            <button
                                type="button"
                                class="btn btn-secondary"
                                id="preview-avatar-btn"
                            >
                                Preview Avatar
                            </button>
                        </div>

                        <!-- New Header Image Section -->
                        <div class="form-group header-image-container">
                            <label for="header-image-url">Header Image URL</label>
                            <input
                                type="url"
                                id="header-image-url"
                                class="form-control"
                                placeholder="https://example.com/header-image.jpg"
                            />
                            <p class="form-text">
                                Optional: Enter a URL for a header/banner image
                            </p>
                        </div>

                        <div class="header-image-container">
                            <img
                                id="header-image-preview"
                                src="/api/placeholder/800/300"
                                alt="Header image preview"
                                class="header-image-preview"
                            />
                            <button
                                type="button"
                                class="btn btn-secondary"
                                id="preview-header-btn"
                            >
                                Preview Header Image
                            </button>
                        </div>

                        <div class="form-row">
                            <div class="form-col">
                                <div class="form-group">
                                    <label for="character-name">Character Name</label>
                                    <input
                                        type="text"
                                        id="character-name"
                                        class="form-control"
                                        required
                                    />
                                    <p class="form-text">Full name of your hockey character</p>
                                </div>
                            </div>
                            <div class="form-col">
                                <div class="form-group">
                                    <label for="team-id">Team</label>
                                    <select id="team-id" class="form-control">
                                        <option value="">Not on a team</option>
                                        <!-- Teams will be loaded dynamically -->
                                    </select>
                                    <p class="form-text">
                                        Select the team your character plays for
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Player Position Section (will be conditionally shown) -->
                    <div id="player-position-section" class="form-section" style="display: none;">
                        <h3 class="form-section-title">Player Position</h3>
                        
                        <div class="position-select-container">
                            <label>Select Player Position</label>
                            <div class="position-options">
                                <div class="position-option" data-position="C">
                                    <div class="position-option-code">C</div>
                                    <div class="position-option-name">Center</div>
                                </div>
                                <div class="position-option" data-position="LW">
                                    <div class="position-option-code">LW</div>
                                    <div class="position-option-name">Left Wing</div>
                                </div>
                                <div class="position-option" data-position="RW">
                                    <div class="position-option-code">RW</div>
                                    <div class="position-option-name">Right Wing</div>
                                </div>
                                <div class="position-option" data-position="D">
                                    <div class="position-option-code">D</div>
                                    <div class="position-option-name">Defense</div>
                                </div>
                                <div class="position-option" data-position="G">
                                    <div class="position-option-code">G</div>
                                    <div class="position-option-name">Goalie</div>
                                </div>
                            </div>
                            <input type="hidden" id="player-position" name="player-position">
                        </div>
                    </div>

                    <!-- Biography Section -->
                    <div class="form-section">
                        <h3 class="form-section-title">Character Background</h3>
                        
                        <div class="form-group">
                            <label for="character-bio">Biography</label>
                            <textarea 
                                id="character-bio" 
                                class="form-control" 
                                rows="6" 
                                placeholder="Write your character's background story, role, and personality..."
                            ></textarea>
                            <p class="form-text">Tell us about your character's history and significance</p>
                        </div>
                    </div>

                    <!-- Character Stats Section for Players -->
                    <div id="player-stats-section" class="form-section" style="display: none;">
                        <h3 class="form-section-title">Player Statistics</h3>

                        <!-- New Jersey Number Input -->
                        <div class="form-group">
                            <label for="jersey-number">Jersey Number</label>
                            <input
                                type="number"
                                id="jersey-number"
                                class="form-control jersey-number-input"
                                min="0"
                                max="99"
                                placeholder="Enter jersey number"
                            />
                            <p class="form-text">Optional: Player's jersey number (0-99)</p>
                        </div>
                        <!-- Common stats for all positions -->
                        <div class="stats-grid">
                            <div class="stat-input-group">
                                <label for="stat-games">Games Played</label>
                                <input
                                    type="number"
                                    id="stat-games"
                                    class="stat-input"
                                    value="0"
                                    min="0"
                                />
                            </div>
                            <div class="stat-input-group">
                                <label for="stat-goals">Goals</label>
                                <input
                                    type="number"
                                    id="stat-goals"
                                    class="stat-input"
                                    value="0"
                                    min="0"
                                />
                            </div>
                            <div class="stat-input-group">
                                <label for="stat-assists">Assists</label>
                                <input
                                    type="number"
                                    id="stat-assists"
                                    class="stat-input"
                                    value="0"
                                    min="0"
                                />
                            </div>
                            <div class="stat-input-group">
                                <label for="stat-plus-minus">Plus/Minus</label>
                                <input
                                    type="number"
                                    id="stat-plus-minus"
                                    class="stat-input"
                                    value="0"
                                />
                            </div>
                            <div class="stat-input-group">
                                <label for="stat-penalties">Penalty Minutes</label>
                                <input
                                    type="number"
                                    id="stat-penalties"
                                    class="stat-input"
                                    value="0"
                                    min="0"
                                />
                            </div>
                            <div class="stat-input-group">
                                <label for="stat-shots">Shots</label>
                                <input
                                    type="number"
                                    id="stat-shots"
                                    class="stat-input"
                                    value="0"
                                    min="0"
                                />
                            </div>
                        </div>

                        <div class="form-section">
                            <h3 class="form-section-title">Character Details</h3>
                            
                            <div class="form-row">
                                <div class="form-col">
                                    <div class="form-group">
                                        <label for="character-age">Age</label>
                                        <input type="number" id="character-age" class="form-control" min="18" max="45" placeholder="Player's age">
                                        <p class="form-text">Age of your character (18-45 for players)</p>
                                    </div>
                                </div>
                                <div class="form-col">
                                    <div class="form-group">
                                        <label for="character-nationality">Nationality</label>
                                        <select id="character-nationality" class="form-control">
                                            <option value="">Select nationality</option>
                                            <option value="Canadian">Canadian</option>
                                            <option value="American">American</option>
                                            <option value="Swedish">Swedish</option>
                                            <option value="Finnish">Finnish</option>
                                            <option value="Russian">Russian</option>
                                            <option value="Czech">Czech</option>
                                            <option value="Slovak">Slovak</option>
                                            <option value="German">German</option>
                                            <option value="Swiss">Swiss</option>
                                            <option value="Danish">Danish</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-col">
                                    <div class="form-group">
                                        <label for="character-hometown">Hometown</label>
                                        <input type="text" id="character-hometown" class="form-control" placeholder="City, State/Province">
                                    </div>
                                </div>
                                <div class="form-col">
                                    <div class="form-group">
                                        <label for="character-years-pro">Years Professional</label>
                                        <input type="number" id="character-years-pro" class="form-control" min="0" max="25" placeholder="Years as a professional">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-col">
                                    <div class="form-group">
                                        <label for="character-height">Height</label>
                                        <input type="text" id="character-height" class="form-control" placeholder="e.g. 6'2&quot;">
                                    </div>
                                </div>
                                <div class="form-col">
                                    <div class="form-group">
                                        <label for="character-weight">Weight</label>
                                        <div class="input-group">
                                            <input type="number" id="character-weight" class="form-control" min="150" max="250" placeholder="Weight in pounds">
                                            <span class="input-group-text">lbs</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-col">
                                    <div class="form-group">
                                        <label for="character-handedness">Shoots/Catches</label>
                                        <select id="character-handedness" class="form-control">
                                            <option value="">Select</option>
                                            <option value="Left">Left</option>
                                            <option value="Right">Right</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Dynamic position-specific stats container -->
                        <div id="dynamic-stats-container" class="dynamic-stats-container">
                            <!-- This will be filled by JavaScript based on position -->
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary" id="submit-btn">
                        Create Character
                    </button>
                </form>
            </div>
        </div>
    </main>
    
    <footer>
        <div class="container">
            <p>&copy; 2025 Northern Attitude Hockey Roleplay. All rights reserved.</p>
        </div>
    </footer>

    <script src="../js/auth-utils.js"></script>
    <script src="../js/character-form/index.js" type="module"></script>
    <script>
        // Setup header image preview
        document.addEventListener('DOMContentLoaded', function() {
            const headerUrlInput = document.getElementById('header-image-url');
            const previewHeaderBtn = document.getElementById('preview-header-btn');
            const headerImagePreview = document.getElementById('header-image-preview');
            
            previewHeaderBtn.addEventListener('click', function() {
                const imageUrl = headerUrlInput.value.trim();
                
                if (imageUrl) {
                    // Update the preview image
                    headerImagePreview.src = imageUrl;
                    
                    // Handle load errors by reverting to placeholder
                    headerImagePreview.onerror = function() {
                        headerImagePreview.src = '/api/placeholder/800/300';
                        window.authUtils.showFormError('character-form', 'Invalid header image URL or image could not be loaded');
                    };
                } else {
                    // If no URL, show placeholder
                    headerImagePreview.src = '/api/placeholder/800/300';
                    window.authUtils.showFormError('character-form', 'Please enter a header image URL');
                }
            });
        });
    </script>
</body>
</html>