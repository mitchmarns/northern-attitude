<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Character | Northern Attitude</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/enhanced-styles.css">
    <link rel="stylesheet" href="https://use.typekit.net/eat5uwv.css">
</head>
<body>
    <header>
        <div class="container header-content">
            <div class="logo">northern<span>attitude</span></div>
            <nav>
                <ul>
                    <li><a href="dash.html">Dashboard</a></li>
                    <li><a href="my-characters.html">Players</a></li>
                    <li><a href="teams.html">Teams</a></li>
                    <li><a href="#">Games</a></li>
                    <li><a href="#">Stats</a></li>
                </ul>
            </nav>
            <div class="user-container">
                <span id="username-display" class="username-display"></span>
                <span> | </span>
                <a href="#" id="logout-link" class="logout-link">Log Out</a>
            </div>
        </div>
    </header>
    
    <main>
        <div class="container">
            <div class="content-header">
                <h2 id="form-title">Create New Character</h2>
                <a href="my-characters.html" class="btn btn-secondary">Back to My Characters</a>
            </div>
            
            <div id="character-form-error" class="auth-error" style="display: none;"></div>
            <div id="character-form-success" class="auth-success" style="display: none;"></div>
            
            <div class="form-container">
                <form id="character-form">
                    <!-- Character Type Selection Section -->
                    <div class="form-section">
                        <h3 class="form-section-title">Character Type</h3>
                        
                        <div class="character-type-select">
                            <div class="character-type-option" data-type="player">
                                <h4>Player</h4>
                                <p>Hockey athletes on the ice</p>
                            </div>
                            <div class="character-type-option" data-type="coach">
                                <h4>Coach</h4>
                                <p>Team managers and trainers</p>
                            </div>
                            <div class="character-type-option" data-type="staff">
                                <h4>Team Staff</h4>
                                <p>Support personnel and management</p>
                            </div>
                            <div class="character-type-option" data-type="executive">
                                <h4>League Executive</h4>
                                <p>League administrators and officials</p>
                            </div>
                            <div class="character-type-option" data-type="fan">
                                <h4>Fan/Supporter</h4>
                                <p>Passionate team and league enthusiasts</p>
                            </div>
                            <div class="character-type-option" data-type="media">
                                <h4>Media</h4>
                                <p>Journalists, broadcasters, analysts</p>
                            </div>
                        </div>

                        <!-- Hidden input to store character type value -->
                        <input type="hidden" id="character-type" name="character-type" required>
                        
                        <div id="character-type-description" class="character-type-description">
                            Select a character type to see more details.
                        </div>
                    </div>
                    
                    <!-- Role Selection (for non-player types) -->
                    <div id="role-selection" class="form-section" style="display: none;">
                        <h3 class="form-section-title">Role Selection</h3>
                        <div id="role-options" class="role-options">
                            <!-- Roles will be dynamically populated -->
                        </div>
                    </div>

                    <!-- Character Basic Info Section -->
                    <div class="form-section">
                        <h3 class="form-section-title">Basic Information</h3>

                        <div class="form-row">
                            <div class="form-col">
                                <div class="form-group">
                                    <label for="character-name">Character Name</label>
                                    <input
                                        type="text"
                                        id="character-name"
                                        class="form-control"
                                        required
                                        placeholder="Enter character name"
                                    />
                                    <p class="form-text">Full name of your hockey character</p>
                                </div>
                            </div>
                            <div class="form-col">
                                <div class="form-group">
                                    <label for="team-id">Team</label>
                                    <select id="team-id" class="form-control">
                                        <option value="">Not on a team</option>
                                        <option value="1">Toronto Maple Leafs</option>
                                        <option value="2">Montreal Canadiens</option>
                                        <option value="3">Boston Bruins</option>
                                        <option value="4">Vancouver Canucks</option>
                                    </select>
                                    <p class="form-text">
                                        Select the team your character belongs to
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="avatar-url">Character Avatar URL</label>
                            <input
                                type="url"
                                id="avatar-url"
                                class="form-control"
                                placeholder="https://example.com/your-image.jpg"
                            />
                            <p class="form-text">
                                Enter a URL to an image for your character's avatar
                            </p>
                        </div>

                        <div class="character-avatar-container">
                            <div class="character-avatar-preview">
                                <img
                                    id="avatar-image"
                                    src="/api/placeholder/120/120"
                                    alt="Character avatar"
                                />
                            </div>
                            <button
                                type="button"
                                class="btn btn-secondary"
                                id="preview-avatar-btn"
                            >
                                Preview Avatar
                            </button>
                        </div>
                    </div>

                    <!-- Player Position Section (will be conditionally shown) -->
                    <div id="player-position-section" class="form-section" style="display: none;">
                        <h3 class="form-section-title">Player Position</h3>
                        
                        <div class="position-select-container">
                            <label>Select Player Position</label>
                            <div class="position-options">
                                <div class="position-option" data-position="C">
                                    <div class="position-option-code">C</div>
                                    <div class="position-option-name">Center</div>
                                </div>
                                <div class="position-option" data-position="LW">
                                    <div class="position-option-code">LW</div>
                                    <div class="position-option-name">Left Wing</div>
                                </div>
                                <div class="position-option" data-position="RW">
                                    <div class="position-option-code">RW</div>
                                    <div class="position-option-name">Right Wing</div>
                                </div>
                                <div class="position-option" data-position="D">
                                    <div class="position-option-code">D</div>
                                    <div class="position-option-name">Defense</div>
                                </div>
                                <div class="position-option" data-position="G">
                                    <div class="position-option-code">G</div>
                                    <div class="position-option-name">Goalie</div>
                                </div>
                            </div>
                            <input type="hidden" id="player-position" name="player-position">
                        </div>
                    </div>

                    <!-- Biography Section -->
                    <div class="form-section">
                        <h3 class="form-section-title">Character Background</h3>
                        
                        <div class="form-group">
                            <label for="character-bio">Biography</label>
                            <textarea 
                                id="character-bio" 
                                class="form-control" 
                                rows="6" 
                                placeholder="Write your character's background story, role, and personality..."
                            ></textarea>
                            <p class="form-text">Tell us about your character's history and significance</p>
                        </div>
                    </div>

                    <!-- Character Stats Section for Players -->
                    <div id="player-stats-section" class="form-section" style="display: none;">
                        <h3 class="form-section-title">Player Statistics</h3>

                        <!-- Common stats for all positions -->
                        <div class="stats-grid">
                            <div class="stat-input-group">
                                <label for="stat-games">Games Played</label>
                                <input
                                    type="number"
                                    id="stat-games"
                                    class="stat-input"
                                    value="0"
                                    min="0"
                                />
                            </div>
                            <div class="stat-input-group">
                                <label for="stat-goals">Goals</label>
                                <input
                                    type="number"
                                    id="stat-goals"
                                    class="stat-input"
                                    value="0"
                                    min="0"
                                />
                            </div>
                            <div class="stat-input-group">
                                <label for="stat-assists">Assists</label>
                                <input
                                    type="number"
                                    id="stat-assists"
                                    class="stat-input"
                                    value="0"
                                    min="0"
                                />
                            </div>
                            <div class="stat-input-group">
                                <label for="stat-plus-minus">Plus/Minus</label>
                                <input
                                    type="number"
                                    id="stat-plus-minus"
                                    class="stat-input"
                                    value="0"
                                />
                            </div>
                            <div class="stat-input-group">
                                <label for="stat-penalties">Penalty Minutes</label>
                                <input
                                    type="number"
                                    id="stat-penalties"
                                    class="stat-input"
                                    value="0"
                                    min="0"
                                />
                            </div>
                            <div class="stat-input-group">
                                <label for="stat-shots">Shots</label>
                                <input
                                    type="number"
                                    id="stat-shots"
                                    class="stat-input"
                                    value="0"
                                    min="0"
                                />
                            </div>
                        </div>

                        <!-- Dynamic position-specific stats container -->
                        <div id="dynamic-stats-container" class="dynamic-stats-container">
                            <!-- This will be filled by JavaScript based on position -->
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary" id="submit-btn">
                        Create Character
                    </button>
                </form>
            </div>
        </div>
    </main>
    
    <footer>
        <div class="container">
            <p>&copy; 2025 Northern Attitude Hockey Roleplay. All rights reserved.</p>
        </div>
    </footer>

    <script src="../js/auth-utils.js"></script>
    <script src="../js/character-form.js"></script>
    <script>
        // Add this script for initial setup of interactive elements
        document.addEventListener('DOMContentLoaded', function() {
            // Character type selection
            const typeOptions = document.querySelectorAll('.character-type-option');
            typeOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Remove selected class from all options
                    typeOptions.forEach(opt => opt.classList.remove('selected'));
                    
                    // Add selected class to clicked option
                    this.classList.add('selected');
                    
                    // Show demo feedback in description
                    const type = this.getAttribute('data-type');
                    const typeDescriptions = {
                        'player': 'Players are the athletes who compete on the ice, representing their teams in hockey matches.',
                        'coach': 'Coaches guide and train players, developing strategies and leading teams to success.',
                        'staff': 'Team staff members provide crucial support behind the scenes, ensuring smooth team operations.',
                        'executive': 'League executives and administrators manage the broader aspects of hockey operations.',
                        'fan': 'Passionate supporters who are deeply involved in the hockey community and team culture.',
                        'media': 'Media professionals who cover, analyze, and report on hockey events and stories.'
                    };
                    
                    document.getElementById('character-type-description').textContent = 
                        typeDescriptions[type] || 'Select a character type to see more details.';
                    
                    // Show/hide sections based on type
                    if (type === 'player') {
                        document.getElementById('player-position-section').style.display = 'block';
                        document.getElementById('player-stats-section').style.display = 'block';
                        document.getElementById('role-selection').style.display = 'none';
                    } else {
                        document.getElementById('player-position-section').style.display = 'none';
                        document.getElementById('player-stats-section').style.display = 'none';
                        document.getElementById('role-selection').style.display = 'block';
                        
                        // Show demo roles
                        const roles = {
                            'coach': ['Head Coach', 'Assistant Coach', 'Goalie Coach', 'Skill Development Coach'],
                            'staff': ['Team Manager', 'Equipment Manager', 'Athletic Therapist', 'Team Doctor'],
                            'executive': ['League Commissioner', 'General Manager', 'Director of Hockey Operations'],
                            'fan': ['Season Ticket Holder', 'Team Superfan', 'Hockey Blogger', 'Fan Club President'],
                            'media': ['Sports Journalist', 'Broadcaster', 'Hockey Analyst', 'Commentator']
                        };
                        
                        const rolesHTML = (roles[type] || []).map((role, idx) => `
                            <div class="role-option">
                                <input type="radio" id="role-${idx}" name="character-role" value="${role}" ${idx === 0 ? 'checked' : ''}>
                                <label for="role-${idx}">${role}</label>
                            </div>
                        `).join('');
                        
                        document.getElementById('role-options').innerHTML = rolesHTML;
                    }
                });
            });
            
            // Position selection
            const positionOptions = document.querySelectorAll('.position-option');
            positionOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Remove selected class from all options
                    positionOptions.forEach(opt => opt.classList.remove('selected'));
                    
                    // Add selected class to clicked option
                    this.classList.add('selected');
                    
                    // Show demo stats based on position
                    const position = this.getAttribute('data-position');
                    let dynamicStatsHTML = '<div class="stats-grid">';
                    
                    switch(position) {
                        case 'C':
                            dynamicStatsHTML += `
                                <div class="stat-input-group">
                                    <label for="stat-faceoff-pct">Faceoff %</label>
                                    <input type="number" id="stat-faceoff-pct" class="stat-input" value="50.0" min="0" max="100" step="0.1">
                                </div>
                                <div class="stat-input-group">
                                    <label for="stat-shooting-pct">Shooting %</label>
                                    <input type="number" id="stat-shooting-pct" class="stat-input" value="10.0" min="0" max="100" step="0.1">
                                </div>
                            `;
                            break;
                        case 'LW':
                        case 'RW':
                            dynamicStatsHTML += `
                                <div class="stat-input-group">
                                    <label for="stat-shooting-pct">Shooting %</label>
                                    <input type="number" id="stat-shooting-pct" class="stat-input" value="10.0" min="0" max="100" step="0.1">
                                </div>
                            `;
                            break;
                        case 'D':
                            dynamicStatsHTML += `
                                <div class="stat-input-group">
                                    <label for="stat-blocks">Blocked Shots</label>
                                    <input type="number" id="stat-blocks" class="stat-input" value="0" min="0">
                                </div>
                                <div class="stat-input-group">
                                    <label for="stat-hits">Hits</label>
                                    <input type="number" id="stat-hits" class="stat-input" value="0" min="0">
                                </div>
                                <div class="stat-input-group">
                                    <label for="stat-ice-time">Avg. Ice Time (min)</label>
                                    <input type="number" id="stat-ice-time" class="stat-input" value="20.0" min="0" step="0.1">
                                </div>
                            `;
                            break;
                        case 'G':
                            dynamicStatsHTML += `
                                <div class="stat-input-group">
                                    <label for="stat-wins">Wins</label>
                                    <input type="number" id="stat-wins" class="stat-input" value="0" min="0">
                                </div>
                                <div class="stat-input-group">
                                    <label for="stat-losses">Losses</label>
                                    <input type="number" id="stat-losses" class="stat-input" value="0" min="0">
                                </div>
                                <div class="stat-input-group">
                                    <label for="stat-gaa">Goals Against Average</label>
                                    <input type="number" id="stat-gaa" class="stat-input" value="2.50" min="0" step="0.01">
                                </div>
                                <div class="stat-input-group">
                                    <label for="stat-save-pct">Save Percentage</label>
                                    <input type="text" id="stat-save-pct" class="stat-input" value=".900">
                                </div>
                                <div class="stat-input-group">
                                    <label for="stat-shutouts">Shutouts</label>
                                    <input type="number" id="stat-shutouts" class="stat-input" value="0" min="0">
                                </div>
                            `;
                            break;
                    }
                    
                    dynamicStatsHTML += '</div>';
                    document.getElementById('dynamic-stats-container').innerHTML = dynamicStatsHTML;
                });
            });
            
            // Avatar preview
            const previewButton = document.getElementById('preview-avatar-btn');
            previewButton.addEventListener('click', function() {
                const imageUrl = document.getElementById('avatar-url').value.trim();
                const avatarImage = document.getElementById('avatar-image');
                
                if (imageUrl) {
                    avatarImage.src = imageUrl;
                    
                    // Handle error
                    avatarImage.onerror = function() {
                        avatarImage.src = '/api/placeholder/120/120';
                        // Show error message in demo
                        const errorDiv = document.getElementById('character-form-error');
                        errorDiv.textContent = 'Invalid image URL or image could not be loaded.';
                        errorDiv.style.display = 'block';
                    };
                    
                    // Handle success
                    avatarImage.onload = function() {
                        // Hide error if showing
                        document.getElementById('character-form-error').style.display = 'none';
                    };
                } else {
                    // Show error for empty URL
                    const errorDiv = document.getElementById('character-form-error');
                    errorDiv.textContent = 'Please enter an image URL.';
                    errorDiv.style.display = 'block';
                }
            });
        });
    </script>
</body>
</html>